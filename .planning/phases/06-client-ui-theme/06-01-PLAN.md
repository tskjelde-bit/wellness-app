---
phase: 06-client-ui-theme
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/globals.css
  - src/app/layout.tsx
  - src/app/(protected)/dashboard/page.tsx
autonomous: true
requirements:
  - UI-01
  - UI-02
  - SESS-07

must_haves:
  truths:
    - "Pink wellness theme colors (blush, rose, charcoal, cream) are applied consistently across all pages"
    - "Mobile viewport is configured with proper scale, theme color, and safe-area handling"
    - "Dashboard shows a prominent Start New Session button linking to /session"
    - "Layout uses min-h-dvh for reliable mobile fullscreen without address-bar jumps"
  artifacts:
    - path: "src/app/globals.css"
      provides: "Expanded @theme with extended colors, shadows, animations, border-radius tokens"
      contains: "--animate-breathe"
    - path: "src/app/layout.tsx"
      provides: "Viewport export for mobile optimization and safe-area padding on body"
      contains: "viewport"
    - path: "src/app/(protected)/dashboard/page.tsx"
      provides: "Themed dashboard with Start New Session link"
      contains: "/session"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/app/globals.css"
      via: "@theme tokens imported by Tailwind"
      pattern: "import.*globals\\.css"
    - from: "src/app/(protected)/dashboard/page.tsx"
      to: "/session"
      via: "Next.js Link component"
      pattern: "href.*session"
---

<objective>
Expand the pink wellness theme token system, configure mobile-optimized viewport, and transform the dashboard into a themed entry point with a session start CTA.

Purpose: Establish the complete design system foundation (colors, shadows, animations, spacing) and mobile viewport so all subsequent UI work references consistent tokens. The dashboard becomes the user's primary entry point to start wellness sessions.

Output: Expanded globals.css with full @theme token set, mobile-configured root layout with viewport export, themed dashboard with "Start New Session" button.
</objective>

<execution_context>
@/Users/torbjorntest/.claude/get-shit-done/workflows/execute-plan.md
@/Users/torbjorntest/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-client-ui-theme/06-RESEARCH.md
@src/app/globals.css
@src/app/layout.tsx
@src/app/(protected)/dashboard/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand theme tokens and configure mobile viewport</name>
  <files>src/app/globals.css, src/app/layout.tsx</files>
  <action>
**globals.css** -- Expand the existing `@theme` block (keeping the 4 base colors already defined) to add:

Extended colors:
- `--color-blush-light: #FDE8F0` (lighter variant for hover/subtle backgrounds)
- `--color-rose-dark: #B02A6E` (darker variant for active/pressed states)
- `--color-charcoal-light: #4A4A4A` (lighter variant for secondary text)

Shadows:
- `--shadow-soft: 0 4px 20px rgba(214, 51, 132, 0.15)` (card elevation with rose tint)
- `--shadow-glow: 0 0 30px rgba(248, 200, 220, 0.4)` (orb glow effect)

Border radius:
- `--radius-card: 1rem`
- `--radius-button: 0.5rem`

Animations (with @keyframes inside @theme):
- `--animate-breathe: breathe 4s ease-in-out infinite` with keyframes: 0%/100% scale(1) opacity(0.7), 50% scale(1.08) opacity(1)
- `--animate-fade-in: fadeIn 0.5s ease-out` with keyframes: from opacity(0) translateY(4px), to opacity(1) translateY(0)
- `--animate-pulse-soft: pulseSoft 3s ease-in-out infinite` with keyframes: 0%/100% box-shadow 20px blush/0.3, 50% box-shadow 40px blush/0.6

Add utility layer after @theme for safe-area padding:
```css
@utility safe-area-padding {
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}
```

**layout.tsx** -- Add static `viewport` export (Next.js 16 pattern) BEFORE the default export:

```typescript
import type { Viewport } from "next";

export const viewport: Viewport = {
  width: "device-width",
  initialScale: 1,
  maximumScale: 1,
  userScalable: false,
  themeColor: [
    { media: "(prefers-color-scheme: light)", color: "#FFF5F7" },
    { media: "(prefers-color-scheme: dark)", color: "#2B2B2B" },
  ],
  viewportFit: "cover",
};
```

Also update the `<body>` tag to include `safe-area-padding` utility class alongside existing font classes. Keep Geist fonts (per research recommendation to defer font changes).
  </action>
  <verify>Run `npx next build 2>&1 | tail -20` to confirm no build errors. Visually inspect globals.css has all tokens defined. Check layout.tsx exports both `viewport` and default function.</verify>
  <done>globals.css contains extended color palette, shadows, border-radius, and 3 animation keyframes in @theme. layout.tsx exports a Viewport object with mobile-optimized settings and body has safe-area padding.</done>
</task>

<task type="auto">
  <name>Task 2: Theme dashboard and add Start Session CTA</name>
  <files>src/app/(protected)/dashboard/page.tsx</files>
  <action>
Redesign the existing dashboard page to:

1. **Background**: Change from `bg-cream` to a subtle gradient: `bg-gradient-to-b from-cream to-blush-light` (uses the new extended color token). Use `min-h-dvh` instead of `min-h-screen` (mobile viewport fix per Research Pitfall 2).

2. **Card**: Keep the existing white card pattern but apply theme tokens:
   - Use `shadow-soft` instead of `shadow-lg` (rose-tinted shadow)
   - Use `rounded-[--radius-card]` for themed border radius

3. **Welcome section**: Keep existing greeting (Welcome, {name/email}) with current styling.

4. **Start Session button**: Add a prominent CTA BEFORE the sign-out form:
   ```tsx
   import Link from "next/link";

   <Link
     href="/session"
     className="flex min-h-[44px] w-full items-center justify-center rounded-lg bg-rose px-4 py-3 font-medium text-white transition-colors hover:bg-rose-dark active:scale-[0.98]"
   >
     Start New Session
   </Link>
   ```
   The min-h-[44px] ensures touch-friendly tap target per mobile best practices. The `active:scale-[0.98]` gives tactile press feedback.

5. **Sign Out button**: Restyle to be secondary/subtle -- change from `bg-rose` to `bg-transparent text-charcoal/60 hover:text-charcoal border border-charcoal/20 hover:border-charcoal/40` so it doesn't compete with the Start Session CTA.

6. **Spacing**: Add `space-y-4` between the CTA and sign-out form for clear visual hierarchy.

The page remains a server component (no 'use client'). The Link to /session is a standard Next.js navigation.
  </action>
  <verify>Run `npx next build 2>&1 | tail -20` to confirm no build errors. Read the dashboard file and verify: Link import exists, href="/session" present, min-h-[44px] on CTA, sign-out is visually secondary.</verify>
  <done>Dashboard has themed gradient background, rose-tinted card shadow, prominent "Start New Session" Link to /session with 44px touch target, and secondary-styled sign-out button. Layout uses min-h-dvh.</done>
</task>

</tasks>

<verification>
1. `npx next build` completes without errors
2. globals.css contains all 7 extended tokens (3 colors, 2 shadows, 2 radii) plus 3 animation keyframes
3. layout.tsx exports `viewport` with width, initialScale, maximumScale, userScalable, themeColor, viewportFit
4. Dashboard page imports Link, has href="/session", uses min-h-dvh, has touch-friendly CTA
5. Sign-out button is visually secondary (not bg-rose)
</verification>

<success_criteria>
- Pink wellness theme tokens fully defined in @theme with extended palette, shadows, animations
- Mobile viewport configured for immersive experience (no zoom, safe areas, theme color)
- Dashboard is the entry point with a prominent "Start New Session" CTA linking to /session
- All existing functionality preserved (auth check, consent check, sign out)
</success_criteria>

<output>
After completion, create `.planning/phases/06-client-ui-theme/06-01-SUMMARY.md`
</output>
